# 19. 機能一覧: 使える機能・使えない機能

## 📊 現在の実装状況（2026年2月8日時点）

### ✅ 使える機能（完全動作）

#### 1. **ダッシュボード**
- ✅ `/admin` - テナントダッシュボード（ドメイン自動識別）
- ✅ KPI表示（総ユーザー数、新規登録数、開封率、CTR、送信数、タスク数）
- ✅ 最近の通知一覧表示
- ✅ ユーザー推移グラフ（データがある場合）
- ✅ 通知パフォーマンスグラフ（データがある場合）

#### 2. **通知管理**
- ✅ `/admin/create` - 通知作成・スケジュール送信
  - 全ユーザー送信
  - セグメント指定送信
  - カスタムフィルター送信
  - `tenant_id`自動設定（ドメインから）

#### 3. **ステップ配信**
- ✅ `/admin/sequences` - ステップ配信一覧・管理
  - シーケンス一覧表示（`tenant_id`でフィルタリング）
  - 有効化/無効化
  - 削除
  - 手動実行
  - 進捗状況表示
- ✅ `/admin/sequences/create` - ステップ配信作成
  - 複数ステップの設定
  - 配信タイミング設定（即時、分後、時間後、日後、時刻指定）
  - `tenant_id`自動設定（ドメインから）

#### 4. **セグメント管理（API実装済み）**
- ✅ `/api/segments?action=list&tenant_id=xxx` - セグメント一覧取得
- ✅ `/api/segments?action=create` - セグメント作成（`tenant_id`対応）
- ✅ `/api/segments?action=preview` - セグメントプレビュー（ユーザー数）

#### 5. **分析・統計（API実装済み）**
- ✅ `/api/analytics?type=overview&tenant_id=xxx` - KPIデータ取得
- ✅ `/api/analytics?type=trends&tenant_id=xxx` - トレンドデータ取得
- ✅ `/api/analytics?type=notifications&tenant_id=xxx` - 通知パフォーマンス取得

#### 6. **トラッキング**
- ✅ `/api/track` - 開封・クリックイベント記録
- ✅ 自動統計更新（`notification_stats`テーブル）

#### 7. **テナント管理**
- ✅ `/api/stats?domain=xxx` - テナント情報取得
- ✅ ドメインベース自動識別
- ✅ マルチテナント対応（全APIで`tenant_id`フィルタリング）

---

### ⚠️ 部分的に使える機能（データ依存）

#### 1. **開封率・CTR**
- ⚠️ API実装済み、データがあれば表示される
- ⚠️ 通知を送信していない場合は0%表示

#### 2. **グラフ**
- ⚠️ API実装済み、データがあれば表示される
- ⚠️ データがない場合は空のグラフ

#### 3. **通知一覧**
- ⚠️ API実装済み、通知があれば表示される
- ⚠️ 通知がない場合は空のリスト

---

### ❌ 使えない機能（未実装）

#### 1. **セグメント管理画面**
- ❌ `/admin/segments` - 専用ページなし
- ✅ APIは実装済み（`/api/segments`）
- 📝 **対応方法**: 既存の`create.html`でセグメント選択は可能

#### 2. **詳細分析画面**
- ❌ `/admin/analytics` - 専用ページなし
- ✅ APIは実装済み（`/api/analytics`）
- 📝 **対応方法**: ダッシュボードに基本分析は表示済み

#### 3. **ユーザー管理画面**
- ❌ `/admin/users` - ページ未作成
- ❌ API未実装（ユーザー一覧取得APIなし）
- 📝 **現状**: ユーザー数は表示されるが、個別管理は不可

#### 4. **設定画面**
- ❌ `/admin/settings` - ページ未作成
- ❌ API未実装（テナント設定変更APIなし）
- 📝 **現状**: テナント情報は表示されるが、変更は不可

#### 5. **タスク管理機能**
- ❌ タスク作成・管理UIなし
- ❌ タスク管理API未実装
- ✅ データベーステーブルは存在（`tasks`）
- 📝 **現状**: タスク数は表示されるが、実際のタスク管理は不可

#### 6. **レポート生成機能**
- ❌ レポート生成UIなし
- ❌ レポート生成API未実装
- ✅ データベーステーブルは存在（`reports`）
- 📝 **現状**: レポート機能は未実装

---

## 🔧 現在のAPI一覧（11個）

### 動作中（11個）

1. ✅ `/api/stats` - テナント情報・統計取得
2. ✅ `/api/analytics` - 分析データ取得（統合API）
3. ✅ `/api/notifications/list` - 通知一覧取得
4. ✅ `/api/notifications/create` - 通知作成
5. ✅ `/api/segments` - セグメント管理（統合API）
6. ✅ `/api/track` - イベントトラッキング（統合API）
7. ✅ `/api/step-sequences` - ステップ配信管理（統合API）
8. ✅ `/api/send-notification` - 即時テスト送信
9. ✅ `/api/register-token` - ユーザー登録
10. ✅ `/api/cron/send-scheduled` - スケジュール通知送信（Cron）
11. ✅ `/api/cron/send-step-notifications` - ステップ通知送信（Cron）

### 未実装（追加可能: 1個まで）

- ❌ `/api/users` - ユーザー一覧・管理（未実装）
- ❌ `/api/tenants` - テナント管理（削除済み、制限回避のため）
- ❌ `/api/tasks` - タスク管理（削除済み、制限回避のため）
- ❌ `/api/reports` - レポート生成（削除済み、制限回避のため）

---

## 📋 機能別詳細

### ✅ 完全動作する機能

#### ダッシュボード (`/admin`)
- **機能**: テナント別ダッシュボード
- **動作**: ✅ 完全動作
- **制約**: データがない項目は0表示
- **API**: `/api/stats`, `/api/analytics`

#### 通知作成 (`/admin/create`)
- **機能**: 通知の作成・スケジュール送信
- **動作**: ✅ 完全動作
- **制約**: なし
- **API**: `/api/notifications/create`, `/api/segments`

#### ステップ配信 (`/admin/sequences`)
- **機能**: ステップ配信の作成・管理
- **動作**: ✅ 完全動作
- **制約**: なし
- **API**: `/api/step-sequences`

#### ステップ配信作成 (`/admin/sequences/create`)
- **機能**: 新しいステップ配信シーケンスの作成
- **動作**: ✅ 完全動作
- **制約**: なし
- **API**: `/api/step-sequences?action=create`

---

### ⚠️ データ依存の機能

#### 開封率・CTR表示
- **機能**: 通知の開封率・クリック率表示
- **動作**: ⚠️ API実装済み、データがあれば表示
- **制約**: 通知を送信していない場合は0%
- **API**: `/api/analytics?type=overview`

#### グラフ表示
- **機能**: ユーザー推移・通知パフォーマンスグラフ
- **動作**: ⚠️ API実装済み、データがあれば表示
- **制約**: データがない場合は空のグラフ
- **API**: `/api/analytics?type=trends`

---

### ❌ 未実装の機能

#### セグメント管理画面 (`/admin/segments`)
- **機能**: セグメントの作成・編集・削除
- **動作**: ❌ 専用ページなし
- **API**: ✅ `/api/segments`（実装済み）
- **代替手段**: 通知作成画面でセグメント選択は可能

#### 詳細分析画面 (`/admin/analytics`)
- **機能**: 詳細な分析データの表示
- **動作**: ❌ 専用ページなし
- **API**: ✅ `/api/analytics`（実装済み）
- **代替手段**: ダッシュボードに基本分析は表示済み

#### ユーザー管理画面 (`/admin/users`)
- **機能**: ユーザー一覧・個別管理
- **動作**: ❌ ページ・APIともに未実装
- **API**: ❌ 未実装
- **現状**: ユーザー数は表示されるが、個別管理は不可

#### 設定画面 (`/admin/settings`)
- **機能**: テナント設定の変更
- **動作**: ❌ ページ・APIともに未実装
- **API**: ❌ 未実装
- **現状**: テナント情報は表示されるが、変更は不可

#### タスク管理機能
- **機能**: タスクの作成・管理
- **動作**: ❌ UI・APIともに未実装
- **API**: ❌ 未実装
- **データベース**: ✅ `tasks`テーブルは存在
- **現状**: タスク数は表示されるが、実際のタスク管理は不可

#### レポート生成機能
- **機能**: レポートの自動生成
- **動作**: ❌ UI・APIともに未実装
- **API**: ❌ 未実装
- **データベース**: ✅ `reports`テーブルは存在
- **現状**: レポート機能は未実装

---

## 🎯 使い方ガイド

### すぐに使える機能

1. **ダッシュボード**: `/admin`にアクセス
   - ドメインから自動でテナントを識別
   - KPIとグラフが表示される

2. **通知作成**: `/admin/create`にアクセス
   - 通知を作成してスケジュール送信
   - セグメント指定も可能

3. **ステップ配信**: `/admin/sequences`にアクセス
   - ステップ配信シーケンスを作成・管理
   - 手動実行も可能

### データを表示するには

1. **通知を送信**: `/admin/create`で通知を作成
2. **ユーザーが開封・クリック**: 自動でトラッキング
3. **ダッシュボードで確認**: 開封率・CTRが表示される

### 使えない機能の代替手段

- **セグメント管理**: 通知作成画面でセグメント選択は可能
- **詳細分析**: ダッシュボードに基本分析は表示済み
- **ユーザー管理**: 現在はユーザー数のみ表示可能
- **設定変更**: 現在は表示のみ、変更は不可

---

## 📝 まとめ

### ✅ 使える機能（11個のAPIで実現）
- ダッシュボード（KPI・グラフ）
- 通知作成・送信
- ステップ配信管理
- セグメント管理（API経由）
- 分析データ取得（API経由）
- トラッキング（自動）

### ❌ 使えない機能
- セグメント管理画面（専用ページなし）
- 詳細分析画面（専用ページなし）
- ユーザー管理画面（未実装）
- 設定画面（未実装）
- タスク管理機能（未実装）
- レポート生成機能（未実装）

### ⚠️ データ依存
- 開封率・CTR（通知送信後に表示）
- グラフ（データがある場合のみ表示）

---

**現在のAPI数**: 11個 / 12個（Vercel Hobby制限）
**追加可能**: 1個まで
