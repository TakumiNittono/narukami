# 01. プロジェクト概要・ディレクトリ構成

## プロダクト名
運営管理事務局 - MVP版

## コンセプト
初心者・個人事業主が、アプリ開発やLINEを使わずに、
時間指定のプッシュ通知（ステップ配信）を配信できるPWA。

## システム構成図

```
[ユーザー端末 (iOS Safari / Android Chrome)]
        │
        ▼
[PWA + Service Worker]  ← Vercel で静的ホスティング
        │
        ├── 通知許可 → FCMトークン取得
        │                   │
        │                   ▼
        │           [Vercel Serverless Function]
        │                   │
        │                   ▼
        │            [Supabase (DB)]
        │                   │
        │                   │  users テーブル
        │                   │  notifications テーブル
        │                   │
        ▼                   │
[Firebase Cloud Messaging]  │
        ▲                   │
        │                   │
[Vercel Serverless Function]┘
        │
        └── Vercel Cron Jobs（1分〜毎日 設定可能）
              └── 予約通知の送信処理
```

## ディレクトリ構成（予定）

```
MVPnarukami/
├── docs/                              # 開発ドキュメント
│   ├── 01_プロジェクト概要・ディレクトリ構成.md
│   ├── 02_技術スタック・環境構築手順.md
│   ├── 03_データベース設計書.md
│   ├── 04_API設計書.md
│   ├── 05_画面仕様書.md
│   ├── 06_FCM・ServiceWorker設計書.md
│   ├── 07_通知送信フロー設計書.md
│   └── 08_開発タスク・スケジュール.md
│
├── public/                            # 静的ファイル（Vercelが自動配信）
│   ├── icons/
│   │   ├── icon-192.png
│   │   └── icon-512.png
│   ├── firebase-messaging-sw.js       # FCM用Service Worker（ルート必須）
│   ├── sw.js                          # PWA用Service Worker
│   └── manifest.json                  # PWAマニフェスト
│
├── pages/                             # ページ（HTMLまたはNext.js不使用の場合）
│   ├── index.html                     # LP / 初期画面（通知許可取得）
│   └── thanks.html                    # 登録完了画面
│
├── api/                               # Vercel Serverless Functions
│   ├── register-token.js              # FCMトークン登録
│   ├── send-notification.js           # テスト送信（即時）
│   ├── notifications/
│   │   ├── create.js                  # 通知作成
│   │   └── list.js                    # 通知一覧取得
│   └── cron/
│       └── send-scheduled.js          # cron予約送信
│
├── admin/                             # 管理画面（静的HTML + JS）
│   ├── index.html                     # 管理画面メイン（通知一覧）
│   ├── create.html                    # 通知作成画面
│   ├── admin.js                       # 管理画面ロジック
│   └── admin.css                      # 管理画面CSS
│
├── lib/                               # 共通ライブラリ
│   ├── supabase.js                    # Supabaseクライアント
│   ├── firebase-admin.js              # Firebase Admin初期化
│   └── auth.js                        # 管理画面認証ミドルウェア
│
├── styles/                            # CSS
│   └── style.css                      # ユーザー向けCSS
│
├── js/                                # フロントエンドJS
│   └── app.js                         # Firebase初期化 + トークン取得
│
├── vercel.json                        # Vercel設定（cron、ルーティング等）
├── package.json                       # Node.js依存パッケージ
├── .env.local                         # 環境変数（ローカル用 ※gitignore対象）
└── .gitignore                         # Git除外設定
```

## 対応端末

| プラットフォーム | ブラウザ | バージョン | PWA | Push通知 |
|---|---|---|---|---|
| iOS | Safari | 16.4以上 | ○ | ○ |
| Android | Chrome | 最新版 | ○ | ○ |

## 補足

- **Vercel** で静的ファイル配信 + Serverless Functions
- **Supabase** をデータベースとして利用（PostgreSQL）
- **Firebase Cloud Messaging (FCM)** でWeb Push通知を送信
- **Vercel Cron Jobs** で定期的に予約通知を送信
- デプロイは **git push** で自動（GitHub連携）
- HTTPS は **Vercelが自動設定**（証明書管理不要）
